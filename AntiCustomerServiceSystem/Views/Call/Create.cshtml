@model Call

@{
	ViewBag.Title = "Create";
}

<h2>Create</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm("Create", "Call", FormMethod.Post, new { @class = "form-horizontal" }))
{
	@Html.ValidationSummary(true)
	<fieldset>
		<legend>Call</legend>
		<input type="hidden" name="issueId" value="@Model.Issue.Id" />
		<div class="control-group">
			<div class="control-label">
				@Html.LabelFor(model => model.Company)
			</div>
			<div class="controls">
				@if (Model.Issue.Companies != null && Model.Issue.Companies.Count > 0)
				{ 
					@Html.DropDownListFor(model => model.Company, (List<SelectListItem>)ViewBag.CompanyList)
				}
				else 
				{ 
					<strong>No companies on this issue yet.</strong> 
				}
				<div>
				<a href="@Url.Action("Create", "Company")" class="btn"><i class="icon-plus"></i> New Company</a> 
				<a href="@Url.Action("ListPicker", "Company", new { issueId = Model.Issue.Id })" class="btn"><i class="icon-list-alt"></i> Choose Existing Company</a>
				</div>
			</div>
		</div>
		<div class="control-group">
			<div class="control-label">
				@Html.LabelFor(model => model.StartTime)
			</div>
			<div class="controls">
				@Html.EditorFor(model => model.StartTime)
				@Html.ValidationMessageFor(model => model.StartTime)
			</div>
		</div>
		<div class="control-group">
		<div class="control-label">
			@Html.LabelFor(model => model.EndTime)
		</div>
		<div class="controls">
			@Html.EditorFor(model => model.EndTime)
			@Html.ValidationMessageFor(model => model.EndTime)
		</div>
		</div>
		<div class="control-group">
		<div class="control-label">
			@Html.LabelFor(model => model.ServiceRep)
		</div>
		<div class="controls">
			@Html.EditorFor(model => model.ServiceRep)
			@Html.ValidationMessageFor(model => model.ServiceRep)
		</div>
		</div>
		<div class="control-group">
		<div class="control-label">
			@Html.LabelFor(model => model.Reference)
		</div>
		<div class="controls">
			@Html.EditorFor(model => model.Reference)
			@Html.ValidationMessageFor(model => model.Reference)
		</div>
		</div>
		<div class="control-group">
		<div class="control-label">
			@Html.LabelFor(model => model.Notes)
		</div>
		<div class="controls">
			@Html.EditorFor(model => model.Notes)
			@Html.ValidationMessageFor(model => model.Notes)
		</div>
		</div>
		<div class="control-group">
		<div class="control-label">
			@Html.LabelFor(model => model.Promises)
		</div>
		<div class="controls">
			@Html.EditorFor(model => model.Promises)
			@Html.ValidationMessageFor(model => model.Promises)
		</div>
		</div>
		<div class="control-group">
		<div class="control-label">
			@Html.LabelFor(model => model.Resolution)
		</div>
		<div class="controls">
			@Html.EditorFor(model => model.Resolution)
			@Html.ValidationMessageFor(model => model.Resolution)
		</div>
		</div>

		<div class="form-actions">
			<input type="submit" value="Create" class="btn btn-primary" />
		</div>
	</fieldset>
}

<div>
	@Html.ActionLink("Back to Issue", "Details", "Issue", new { id = Model.Issue.Id }, null)
</div>
